{"ast":null,"code":"var _jsxFileName = \"/Users/mac/ironhack/lab/module_III/toysland/front/src/components/context/AuthContext.js\";\nimport React, { createContext } from 'react';\nimport ToyslandService from '../../services/ToyslandService';\nimport { Redirect } from 'react-router-dom';\nimport PrivateRoute from '../src/guards/PrivateRoute';\nconst AuthContext = createContext();\nexport class AuthContextProvider extends React.Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      user: JSON.parse(localStorage.getItem('user'))\n    };\n\n    this.setUser = user => {\n      localStorage.setItem('user', user ? JSON.stringify(user) : null);\n      this.setState({\n        user\n      });\n    };\n\n    this.logout = () => {\n      ToyslandService.logout().then(() => {\n        this.setUser();\n        return React.createElement(Redirect, {\n          to: \"/\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 23\n          },\n          __self: this\n        });\n      });\n    };\n\n    this.isAuthenticated = () => {\n      return this.state.user && this.state.user.username;\n    };\n  }\n\n  render() {\n    const value = {\n      currentUser: this.state.user,\n      setUser: this.setUser,\n      logout: this.logout\n    };\n    return React.createElement(AuthContext.Provider, {\n      value: value,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 39\n      },\n      __self: this\n    }, this.props.children);\n  }\n\n}\n;\nexport const WithAuthConsumer = WrappedComponent => props => React.createElement(AuthContext.Consumer, {\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 50\n  },\n  __self: this\n}, authProps => React.createElement(WrappedComponent, Object.assign({}, props, authProps, {\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 51\n  },\n  __self: this\n})));\nexport default AuthContext;","map":{"version":3,"sources":["/Users/mac/ironhack/lab/module_III/toysland/front/src/components/context/AuthContext.js"],"names":["React","createContext","ToyslandService","Redirect","PrivateRoute","AuthContext","AuthContextProvider","Component","state","user","JSON","parse","localStorage","getItem","setUser","setItem","stringify","setState","logout","then","isAuthenticated","username","render","value","currentUser","props","children","WithAuthConsumer","WrappedComponent","authProps"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,aAAhB,QAAqC,OAArC;AACA,OAAOC,eAAP,MAA4B,gCAA5B;AACA,SAASC,QAAT,QAAyB,kBAAzB;AACA,OAAOC,YAAP,MAAyB,4BAAzB;AAGA,MAAMC,WAAW,GAAGJ,aAAa,EAAjC;AAEA,OAAO,MAAMK,mBAAN,SAAkCN,KAAK,CAACO,SAAxC,CAAkD;AAAA;AAAA;AAAA,SACrDC,KADqD,GAC/C;AACFC,MAAAA,IAAI,EAAEC,IAAI,CAACC,KAAL,CAAWC,YAAY,CAACC,OAAb,CAAqB,MAArB,CAAX;AADJ,KAD+C;;AAAA,SAKrDC,OALqD,GAK1CL,IAAD,IAAU;AAChBG,MAAAA,YAAY,CAACG,OAAb,CAAqB,MAArB,EAA6BN,IAAI,GAAGC,IAAI,CAACM,SAAL,CAAeP,IAAf,CAAH,GAA0B,IAA3D;AACA,WAAKQ,QAAL,CAAc;AAACR,QAAAA;AAAD,OAAd;AACH,KARoD;;AAAA,SAUrDS,MAVqD,GAU5C,MAAM;AACXhB,MAAAA,eAAe,CAACgB,MAAhB,GACKC,IADL,CACU,MAAM;AACR,aAAKL,OAAL;AACA,eAAO,oBAAC,QAAD;AAAU,UAAA,EAAE,EAAC,GAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UAAP;AACH,OAJL;AAKH,KAhBoD;;AAAA,SAkBrDM,eAlBqD,GAkBnC,MAAM;AACpB,aAAO,KAAKZ,KAAL,CAAWC,IAAX,IAAmB,KAAKD,KAAL,CAAWC,IAAX,CAAgBY,QAA1C;AACD,KApBkD;AAAA;;AAsBrDC,EAAAA,MAAM,GAAG;AACT,UAAMC,KAAK,GAAG;AACZC,MAAAA,WAAW,EAAE,KAAKhB,KAAL,CAAWC,IADZ;AAEZK,MAAAA,OAAO,EAAE,KAAKA,OAFF;AAGZI,MAAAA,MAAM,EAAE,KAAKA;AAHD,KAAd;AAMA,WACI,oBAAC,WAAD,CAAa,QAAb;AAAsB,MAAA,KAAK,EAAGK,KAA9B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACK,KAAKE,KAAL,CAAWC,QADhB,CADJ;AAKC;;AAlCoD;AAsCxD;AAED,OAAO,MAAMC,gBAAgB,GAAIC,gBAAD,IAAuBH,KAAD,IAClD,oBAAC,WAAD,CAAa,QAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GACMI,SAAD,IAAgB,oBAAC,gBAAD,oBAAsBJ,KAAtB,EAAiCI,SAAjC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GADrB,CADG;AAMP,eAAexB,WAAf","sourcesContent":["import React, { createContext } from 'react'\nimport ToyslandService from '../../services/ToyslandService'\nimport { Redirect } from 'react-router-dom';\nimport PrivateRoute from '../src/guards/PrivateRoute'\n\n\nconst AuthContext = createContext();\n\nexport class AuthContextProvider extends React.Component {\n    state={\n        user: JSON.parse(localStorage.getItem('user'))\n    }\n\n    setUser = (user) => {\n        localStorage.setItem('user', user ? JSON.stringify(user) : null)\n        this.setState({user})\n    }\n\n    logout = () => {\n        ToyslandService.logout()\n            .then(() => {\n                this.setUser()\n                return <Redirect to=\"/\"/>\n            })\n    }\n\n    isAuthenticated = () => {\n        return this.state.user && this.state.user.username;\n      }\n\n    render() {\n    const value = {\n      currentUser: this.state.user,\n      setUser: this.setUser,\n      logout: this.logout\n    }\n\n    return(\n        <AuthContext.Provider value ={value}>\n            {this.props.children}\n        </AuthContext.Provider>\n    )\n    }\n\n\n\n};\n\nexport const WithAuthConsumer = (WrappedComponent) => (props) => (\n    <AuthContext.Consumer>\n        {(authProps) => (<WrappedComponent {...props} {...authProps} />)}\n    </AuthContext.Consumer>\n)\n\nexport default AuthContext;"]},"metadata":{},"sourceType":"module"}