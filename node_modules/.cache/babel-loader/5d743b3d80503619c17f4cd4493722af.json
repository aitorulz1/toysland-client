{"ast":null,"code":"import _toConsumableArray from\"/Users/mac/ironhack/lab/module_III/toysland/front/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _defineProperty from\"/Users/mac/ironhack/lab/module_III/toysland/front/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/Users/mac/ironhack/lab/module_III/toysland/front/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _classCallCheck from\"/Users/mac/ironhack/lab/module_III/toysland/front/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/mac/ironhack/lab/module_III/toysland/front/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/mac/ironhack/lab/module_III/toysland/front/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/mac/ironhack/lab/module_III/toysland/front/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/Users/mac/ironhack/lab/module_III/toysland/front/node_modules/@babel/runtime/helpers/esm/inherits\";import React,{Component}from'react';import{WithAuthConsumer}from'../context/AuthContext';import ToyslandService from'../../services/ToyslandService';import{Redirect}from'react-router-dom';import Lateral from'../misc/Lateral';var EditProduct=/*#__PURE__*/function(_Component){_inherits(EditProduct,_Component);function EditProduct(props){var _this;_classCallCheck(this,EditProduct);_this=_possibleConstructorReturn(this,_getPrototypeOf(EditProduct).call(this,props));_this.handleChange=function(event){var _event$target=event.target,name=_event$target.name,value=_event$target.value,files=_event$target.files;_this.setState({data:_objectSpread({},_this.state.data,_defineProperty({},name,files?files[0]:value))},function(){return console.log('imagen',_this.state.data.productPicture);});};_this.handleSubmit=function(event){event.preventDefault();var formData=new FormData();formData.append('category',_this.state.data.category);formData.append('name',_this.state.data.name);formData.append('price',_this.state.data.price);formData.append('description',_this.state.data.description);formData.append('productPicture',_this.state.data.productPicture);_this.setState({loading:true,error:false},function(){console.log(formData);ToyslandService.editProduct(formData,_this.state.data.id).then(function(product){_this.props.setUser(_objectSpread({},_this.props.currentUser,{product:[].concat(_toConsumableArray(_this.props.currentUser.product.filter(function(e){return e.id!==product.id;})),[product])}));_this.setState({success:true});}).catch(function(){_this.setState({error:true,loading:false});});});};var _product=props.currentUser.product.find(function(product){return product.id===props.match.params.id;});// encuentro el producto que tengo en el context\n_this.state={currentImage:_product.productPicture,data:{id:_product.id,category:_product.category,name:_product.name,price:_product.price,description:_product.description,productPicture:_product.productPicture},success:false};return _this;}_createClass(EditProduct,[{key:\"render\",value:function render(){console.log(this.state.data);if(this.state.success){return React.createElement(Redirect,{to:\"/products\"});}return React.createElement(\"div\",{className:\"EditContainer\"},React.createElement(\"div\",{className:\"LateralDiv\"},React.createElement(Lateral,null)),React.createElement(\"div\",{className:\"EditContainerContainer\"},React.createElement(\"div\",{className:\"EditContainerContainerContainer\"},React.createElement(\"div\",{className:\"TuPerfilContainer\"},React.createElement(\"p\",{className:\"tit\"},\"Tu Producto\"),React.createElement(\"p\",{className:\"subtit\"},\"Aqu\\xED podr\\xE1s ver y editar los datos de tu producto\")),React.createElement(\"div\",{className:\"Edit-Image\"},React.createElement(\"form\",{onSubmit:this.handleSubmit,encType:\"multipart/form-data\"},React.createElement(\"div\",{className:\"form-container\"},React.createElement(\"div\",{className:\"form-title\"},\"Imagen de perfil\"),React.createElement(\"div\",{className:\"form-group\"},React.createElement(\"label\",{htmlFor:\"name\"},\"Imagen Principal\"),React.createElement(\"div\",{className:\"ProfileImageContainer\"},React.createElement(\"img\",{src:this.state.currentImage,alt:\"my prfile pic\"})),React.createElement(\"input\",{onChange:this.handleChange,name:\"productPicture\",type:\"file\",className:\"form-group\",id:\"avatar\"})),React.createElement(\"button\",{type:\"submit\",className:\"btn btn-toysland\",disabled:this.state.loading},\"Guardar Cambios\")))),React.createElement(\"div\",{className:\"Edit\"},React.createElement(\"form\",{onSubmit:this.handleSubmit},React.createElement(\"div\",{className:\"form-container\"},React.createElement(\"div\",{className:\"form-title\"},\"Mi Producto\"),React.createElement(\"div\",{className:\"form-group-info\"},React.createElement(\"label\",{htmlFor:\"name\"},\"Nombre\"),React.createElement(\"input\",{value:this.state.data.name,onChange:this.handleChange,autoComplete:\"off\",name:\"name\",type:\"text\",className:\"form-control\",id:\"name\",placeholder:\"Nombre\"})),React.createElement(\"div\",{className:\"form-group-info\"},React.createElement(\"label\",{htmlFor:\"price\"},\"Precio\"),React.createElement(\"input\",{value:this.state.data.price,onChange:this.handleChange,autoComplete:\"off\",name:\"price\",type:\"number\",className:\"form-control\",id:\"price\",placeholder:\"Price\"})),React.createElement(\"div\",{className:\"form-group-info\"},React.createElement(\"label\",{htmlFor:\"description\"},\"Descripci\\xF3n\"),React.createElement(\"input\",{value:this.state.data.description,onChange:this.handleChange,autoComplete:\"off\",name:\"description\",type:\"text\",className:\"form-control\",id:\"description\",placeholder:\"M\\xE1x 140 caracteres\"})),React.createElement(\"button\",{type:\"submit\",className:\"btn btn-toysland\",disabled:this.state.loading},\"Guardar Cambios\")))))),React.createElement(\"div\",{className:\"Space\"}));}}]);return EditProduct;}(Component);export default WithAuthConsumer(EditProduct);","map":{"version":3,"sources":["/Users/mac/ironhack/lab/module_III/toysland/front/src/components/misc/EditProduct.js"],"names":["React","Component","WithAuthConsumer","ToyslandService","Redirect","Lateral","EditProduct","props","handleChange","event","target","name","value","files","setState","data","state","console","log","productPicture","handleSubmit","preventDefault","formData","FormData","append","category","price","description","loading","error","editProduct","id","then","product","setUser","currentUser","filter","e","success","catch","find","match","params","currentImage"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\nimport { WithAuthConsumer } from '../context/AuthContext'\nimport ToyslandService from '../../services/ToyslandService'\nimport { Redirect } from 'react-router-dom'\nimport Lateral from '../misc/Lateral'\n\nclass EditProduct extends Component {\n\n        constructor(props) {\n            super(props)\n\n            const product = props.currentUser.product.find(product => product.id === props.match.params.id) // encuentro el producto que tengo en el context\n\n            this.state = {\n                currentImage: product.productPicture,\n                data: {\n                    id: product.id,\n                    category: product.category,\n                    name: product.name,\n                    price: product.price,\n                    description: product.description,\n                    productPicture: product.productPicture\n                },\n                success: false\n            }\n        }\n\n\n        handleChange = (event) => {\n            const {name, value, files} = event.target\n            this.setState({\n\n                data: {\n                    ...this.state.data,\n                    [name] : files ? files[0] : value\n                }\n            }, () => console.log('imagen', this.state.data.productPicture))\n        }\n\n        handleSubmit = (event) => {\n            event.preventDefault()\n\n            const formData = new FormData()\n                formData.append('category', this.state.data.category)\n                formData.append('name', this.state.data.name)\n                formData.append('price', this.state.data.price)\n                formData.append('description', this.state.data.description)\n                formData.append('productPicture', this.state.data.productPicture)\n\n            this.setState({loading: true, error: false}, () => {\n                console.log(formData)\n                ToyslandService.editProduct(formData, this.state.data.id)\n                    .then((product) => {\n\n                        this.props.setUser({\n                            ...this.props.currentUser, \n                            product: [\n                                ...this.props.currentUser.product.filter(e => e.id !== product.id), \n                                product\n                            ]})\n                        this.setState({success: true})\n                    })\n                    .catch(() => {\n                        this.setState({error: true, loading: false})\n                    })\n            })\n        }\n\n        render() {    \n            console.log(this.state.data)\n            if(this.state.success) {\n               \n                return <Redirect to='/products' />\n            }\n            return (\n                <div className=\"EditContainer\">\n\n                    <div className=\"LateralDiv\">\n                        <Lateral />\n                    </div>\n\n                    <div className='EditContainerContainer'>\n\n                    <div className='EditContainerContainerContainer'>\n\n                            <div className=\"TuPerfilContainer\">\n                                <p className=\"tit\">Tu Producto</p>\n                                <p className=\"subtit\">Aquí podrás ver y editar los datos de tu producto</p>\n                            </div>\n\n\n                                                        {/* IMAGE */}\n\n\n                            <div className=\"Edit-Image\">\n                                <form onSubmit={this.handleSubmit} encType=\"multipart/form-data\">\n\n                                    \n\n                                    <div className=\"form-container\">\n\n                                        <div className=\"form-title\">Imagen de perfil</div>\n\n                                            <div className='form-group'>\n                                                <label htmlFor=\"name\">Imagen Principal</label>\n                                                \n                                            <div className=\"ProfileImageContainer\">\n                                                <img src={this.state.currentImage} alt=\"my prfile pic\" />\n                                            </div>\n\n                                                <input \n                                                    onChange={this.handleChange}\n                                                    name='productPicture'\n                                                    type='file'\n                                                    className='form-group'\n                                                    id='avatar'\n                                                />\n                                            </div>\n\n                                            <button\n                                                type='submit'\n                                                className='btn btn-toysland'\n                                                disabled={this.state.loading}\n                                            >\n                                                Guardar Cambios\n                                            </button>\n                                    </div>\n\n\n                                </form>\n                            </div>                        \n\n                            <div className=\"Edit\">\n                                <form onSubmit={this.handleSubmit}>\n\n                                <div className=\"form-container\">     \n\n                                    <div className=\"form-title\">Mi Producto</div>\n\n                                            <div className=\"form-group-info\">\n                                                <label htmlFor=\"name\">Nombre</label>\n\n                                                <input\n                                                    value={this.state.data.name}\n                                                    onChange={this.handleChange}\n                                                    autoComplete=\"off\"\n                                                    name=\"name\"\n                                                    type=\"text\"\n                                                    className='form-control'\n                                                    id=\"name\"\n                                                    placeholder=\"Nombre\"\n                                                />\n                                            </div>\n\n                                <div className=\"form-group-info\">\n                                    <label htmlFor=\"price\">Precio</label>\n\n                                    <input \n                                        value={this.state.data.price}\n                                        onChange={this.handleChange}\n                                        autoComplete=\"off\"\n                                        name=\"price\"\n                                        type=\"number\"\n                                        className='form-control'\n                                        id=\"price\"\n                                        placeholder=\"Price\"                       \n                                    />\n                                </div>\n\n\n                                <div className=\"form-group-info\">\n                                    <label htmlFor=\"description\">Descripción</label>\n\n                                    <input \n                                        value={this.state.data.description}\n                                        onChange={this.handleChange}\n                                        autoComplete=\"off\"\n                                        name=\"description\"\n                                        type=\"text\"\n                                        className='form-control'\n                                        id=\"description\"\n                                        placeholder=\"Máx 140 caracteres\"                       \n                                    />\n                                </div>\n\n\n                                                <button\n                                                    type='submit'\n                                                    className='btn btn-toysland'\n                                                    disabled={this.state.loading}\n                                                >\n                                                    Guardar Cambios\n                                                </button>\n\n                                                \n                                            </div>{/* //Fin de form-container */}\n\n\n\n                                                </form>\n                                                </div>\n                                            </div>\n                                        </div>\n                                    <div className=\"Space\"></div>\n                                </div>\n\n            )\n        }\n}\n\nexport default WithAuthConsumer(EditProduct)"]},"metadata":{},"sourceType":"module"}