{"ast":null,"code":"import _toConsumableArray from\"/Users/mac/ironhack/lab/module_III/toysland/front/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _defineProperty from\"/Users/mac/ironhack/lab/module_III/toysland/front/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/Users/mac/ironhack/lab/module_III/toysland/front/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _classCallCheck from\"/Users/mac/ironhack/lab/module_III/toysland/front/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/mac/ironhack/lab/module_III/toysland/front/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/mac/ironhack/lab/module_III/toysland/front/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/mac/ironhack/lab/module_III/toysland/front/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/Users/mac/ironhack/lab/module_III/toysland/front/node_modules/@babel/runtime/helpers/esm/inherits\";import React,{Component}from'react';import ToyslandService from'../../services/ToyslandService';import{Redirect}from'react-router-dom';import{WithAuthConsumer}from'../context/AuthContext';var UpProduct=/*#__PURE__*/function(_Component){_inherits(UpProduct,_Component);function UpProduct(){var _getPrototypeOf2;var _this;_classCallCheck(this,UpProduct);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_possibleConstructorReturn(this,(_getPrototypeOf2=_getPrototypeOf(UpProduct)).call.apply(_getPrototypeOf2,[this].concat(args)));_this.state={data:{category:'Vintage',name:'',price:0,description:'',productPicture:null},error:false,loading:false,success:false,categories:[]};_this.handleChange=function(event){var _event$target=event.target,name=_event$target.name,value=_event$target.value,files=_event$target.files;_this.setState({data:_objectSpread({},_this.state.data,_defineProperty({},name,files?files[0]:value))});};_this.handleSubmit=function(event){event.preventDefault();var formData=new FormData();formData.append('category',_this.state.data.category);formData.append('name',_this.state.data.name);formData.append('price',_this.state.data.price);formData.append('description',_this.state.data.description);formData.append('productPicture',_this.state.data.productPicture);formData.append('user',_this.props.currentUser.id);_this.setState({loading:true,error:false},function(){ToyslandService.product(formData).then(function(product){console.log('ENTRA');_this.props.setUser(_objectSpread({},_this.props.currentUser,{product:[].concat(_toConsumableArray(_this.props.currentUser.product),[product])}));_this.setState({success:true});}).catch(function(error){_this.setState({error:true,loading:false});});});};_this.componentDidMount=function(){ToyslandService.categories().then(function(categories){_this.setState({categories:categories.map(function(c){return c.category;})// Las de state\n});});};return _this;}_createClass(UpProduct,[{key:\"render\",value:function render(){var errorClassName=this.state.error?'is-invalid':'';if(this.state.success){return React.createElement(Redirect,{to:\"/\"});}return React.createElement(\"div\",{className:\"RegisterContainer\"},React.createElement(\"div\",{className:\"RegisterContainerContainer\"},React.createElement(\"div\",{className:\"Register\"},React.createElement(\"form\",{onSubmit:this.handleSubmit},React.createElement(\"div\",{className:\"form-group\"},React.createElement(\"label\",{htmlFor:\"category\"},\"Elige la Categor\\xEDa\"),React.createElement(\"select\",{id:\"category\",name:\"category\",form:\"carform\",onChange:this.handleChange},this.state.categories.map(function(c,i){return React.createElement(\"option\",{key:i,value:c},c);}))),React.createElement(\"div\",{className:\"form-group\"},React.createElement(\"label\",{htmlFor:\"name\"},\"Nombre\"),React.createElement(\"input\",{value:this.state.data.name,onChange:this.handleChange,autoComplete:\"off\",name:\"name\",type:\"text\",className:\"form-control \".concat(errorClassName),id:\"name\",placeholder:\"Nombre\"})),React.createElement(\"div\",{className:\"form-group\"},React.createElement(\"label\",{htmlFor:\"price\"},\"Precio\"),React.createElement(\"input\",{value:this.state.data.price,onChange:this.handleChange,autoComplete:\"off\",name:\"price\",type:\"number\",className:\"form-control \".concat(errorClassName),id:\"price\",placeholder:\"Price\"})),React.createElement(\"div\",{className:\"form-group\"},React.createElement(\"label\",{htmlFor:\"description\"},\"Descripci\\xF3n\"),React.createElement(\"input\",{value:this.state.data.description,onChange:this.handleChange,autoComplete:\"off\",name:\"description\",type:\"text\",className:\"form-control \".concat(errorClassName),id:\"description\",placeholder:\"M\\xE1x 140 caracteres\"})),React.createElement(\"div\",{className:\"form-group\"},React.createElement(\"label\",{htmlFor:\"productPicture\"},\"Im\\xE1genes\"),React.createElement(\"input\",{multiple:true,onChange:this.handleChange,name:\"productPicture\",type:\"file\",className:\"form-group \".concat(errorClassName),id:\"productPicture\"})),React.createElement(\"button\",{type:\"submit\",className:\"btn btn-toysland\",disabled:this.state.loading},\"Subir Producto\")))),React.createElement(\"div\",{className:\"Space\"}));}}]);return UpProduct;}(Component);export default WithAuthConsumer(UpProduct);","map":{"version":3,"sources":["/Users/mac/ironhack/lab/module_III/toysland/front/src/components/misc/UpProduct.js"],"names":["React","Component","ToyslandService","Redirect","WithAuthConsumer","UpProduct","state","data","category","name","price","description","productPicture","error","loading","success","categories","handleChange","event","target","value","files","setState","handleSubmit","preventDefault","formData","FormData","append","props","currentUser","id","product","then","console","log","setUser","catch","componentDidMount","map","c","errorClassName","i"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\nimport ToyslandService from '../../services/ToyslandService'\nimport { Redirect } from 'react-router-dom'\nimport { WithAuthConsumer } from '../context/AuthContext'\n\nclass UpProduct extends Component {\n\n    state = {\n        data: {\n            category: 'Vintage',\n            name: '',\n            price: 0,\n            description: '',\n            productPicture: null\n        },\n        error: false,\n        loading: false,\n        success: false,\n        categories: []\n    }\n\n    handleChange = (event) => {\n        const {name, value, files} = event.target\n\n        this.setState({\n            data: {\n                ...this.state.data,\n                [name] : files ? files[0] : value\n            }\n        })\n    }\n\n    handleSubmit = (event) => {\n        event.preventDefault()\n\n        const formData = new FormData()\n            formData.append('category',this.state.data.category)\n            formData.append('name',this.state.data.name)\n            formData.append('price',this.state.data.price)\n            formData.append('description',this.state.data.description)\n            formData.append('productPicture',this.state.data.productPicture)\n            formData.append('user', this.props.currentUser.id)\n\n            \n\n            this.setState({loading: true, error: false}, () => {\n            ToyslandService.product(formData)\n                .then((product) => {     \n                    console.log('ENTRA')\n                    this.props.setUser({ ...this.props.currentUser, product: [...this.props.currentUser.product, product]})\n                    this.setState({success: true})\n                })\n                .catch(error => {\n                    this.setState({ error: true, loading: false })\n                })\n            })\n    }\n\n    componentDidMount = () => {\n        ToyslandService.categories()\n            .then(categories => {\n                this.setState({\n                    categories: categories.map(c => c.category) // Las de state\n                })\n            }\n        )\n    }\n\n    render() {\n        const errorClassName = this.state.error ? 'is-invalid' : ''\n\n        if(this.state.success) {\n            return <Redirect to='/' />\n        }\n\n        return (\n        <div className=\"RegisterContainer\">\n        <div className=\"RegisterContainerContainer\">\n            <div className=\"Register\">\n                <form onSubmit={this.handleSubmit}>\n\n                    <div className=\"form-group\">\n                        <label htmlFor=\"category\">Elige la Categoría</label>\n\n                        <select id=\"category\" name=\"category\" form=\"carform\" onChange={this.handleChange} > \n                            {this.state.categories.map((c, i) => {\n                                return <option key={i} value={c}>{c}</option>\n                            })}\n                        </select>\n                    </div>\n\n                    <div className=\"form-group\">\n                        <label htmlFor=\"name\">Nombre</label>\n\n                        <input \n                            value={this.state.data.name}\n                            onChange={this.handleChange}\n                            autoComplete=\"off\"\n                            name=\"name\"\n                            type=\"text\"\n                            className={`form-control ${errorClassName}`}\n                            id=\"name\"\n                            placeholder=\"Nombre\"                       \n                        />\n                    </div>\n\n                    <div className=\"form-group\">\n                        <label htmlFor=\"price\">Precio</label>\n\n                        <input \n                            value={this.state.data.price}\n                            onChange={this.handleChange}\n                            autoComplete=\"off\"\n                            name=\"price\"\n                            type=\"number\"\n                            className={`form-control ${errorClassName}`}\n                            id=\"price\"\n                            placeholder=\"Price\"                       \n                        />\n                    </div>\n\n                    {/* <div className=\"form-group\">\n                        <label htmlFor=\"coin\">Moneda</label>\n\n                        <select id=\"coin\" name=\"coin\" form=\"coin\" onChange={this.handleChange}>\n                            <option value=\"€\">€</option>\n                            <option value=\"$\">$</option>\n                            <option value=\"£\">£</option>\n                        </select>\n\n                    </div> */}\n\n                    <div className=\"form-group\">\n                        <label htmlFor=\"description\">Descripción</label>\n\n                        <input \n                            value={this.state.data.description}\n                            onChange={this.handleChange}\n                            autoComplete=\"off\"\n                            name=\"description\"\n                            type=\"text\"\n                            className={`form-control ${errorClassName}`}\n                            id=\"description\"\n                            placeholder=\"Máx 140 caracteres\"                       \n                        />\n                    </div>\n\n                    \n                    <div className='form-group'>\n                                <label htmlFor='productPicture'>Imágenes</label>\n\n                                <input multiple \n                                    onChange={this.handleChange}\n                                    name='productPicture'\n                                    type='file'\n                                    className={`form-group ${errorClassName}`}\n                                    id='productPicture'\n                                />\n\n\n                    </div>\n\n                    <button\n                        type='submit'\n                        className='btn btn-toysland'\n                        disabled={this.state.loading}\n                    >\n                        Subir Producto\n                    </button>\n\n                </form>\n            </div>\n            </div>\n            <div className=\"Space\"></div>\n        </div>\n        )\n    }\n}\n\n\n\nexport default WithAuthConsumer (UpProduct)\n"]},"metadata":{},"sourceType":"module"}